%% LyX 2.3.4.2 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[english,xcolor=svgnames, handout]{beamer}
\usepackage{mathpazo}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}
\usepackage{calc}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{graphicx}

\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.
% this default might be overridden by plain title style
\newcommand\makebeamertitle{\frame{\maketitle}}%
% (ERT) argument for the TOC
\AtBeginDocument{%
  \let\origtableofcontents=\tableofcontents
  \def\tableofcontents{\@ifnextchar[{\origtableofcontents}{\gobbletableofcontents}}
  \def\gobbletableofcontents#1{\origtableofcontents}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\setcounter{MaxMatrixCols}{10}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{mathpazo}
\usepackage{hyperref}
%\usepackage{multimedia}
\usepackage{movie15}
\usepackage{xcolor}
\usepackage{colortbl}
\definecolor{RawSienna}{cmyk}{0,0.87,0.82,0.31}
\definecolor{gray97}{cmyk}{0,0,0,0.03}
\definecolor{robinsegg}{cmyk}{0.18,0.04,0,0.07}
\definecolor{cola}{cmyk}{0,0.315,0.35,0.155}

\newenvironment{stepenumerate}{\begin{enumerate}[<+->]}{\end{enumerate}}
\newenvironment{stepitemize}{\begin{itemize}[<+->]}{\end{itemize} }
\newenvironment{stepenumeratewithalert}{\begin{enumerate}[<+-| alert@+>]}{\end{enumerate}}
\newenvironment{stepitemizewithalert}{\begin{itemize}[<+-| alert@+>]}{\end{itemize} }
\usecolortheme[named=RawSienna]{structure}
%\usecolortheme[RGB={205,0,0}]{structure}
\setbeamertemplate{navigation symbols}{}
\useoutertheme{infolines}
\usetheme{default}
\setbeamertemplate{blocks}[shadow=true]
%\setbeamerfont{structure}{shape=\itshape}
\usefonttheme{structuresmallcapsserif}
\setbeamertemplate{background canvas}{
 % \ifnum \thepage>0 \relax % we are on the first page
%\includegraphics[width=\paperwidth,height=\paperheight]{/home/mv/Dropbox/Foton/IconsWallpaper/greyribbonLighter.jpg}
 % \else
 	% No background for page 2 and onwards
 % \fi
}

\makeatother

\usepackage{babel}
\begin{document}
<<setup, include=FALSE>>=
library(knitr)
library(ggplot2)
library(tikzDevice)
source("MVutils.R")
opts_chunk$set(fig.path='figure/beamer-',fig.align='center',fig.show='hold',size='footnotesize')
@

<<echo=FALSE>>=
read_chunk('Lecture3SlideCode.R')
@
\title[TDAB01]{Sannolikhetslära och Statistik\\
Föreläsning 3}
\author[Mattias Villani]{Mattias Villani}
\institute[\textbf{STIMA, LiU}]{\textbf{Avdelningen för Statistik och Maskininlärning}\\
\textbf{Institutionen för datavetenskap}\\
\textbf{Linköpings universitet }}
\date{\includegraphics[scale=0.15]{LiU_secondary_1_black}\,}
\makebeamertitle
\begin{frame}{Översikt}

\begin{itemize}
\item \textrm{\textbf{\textcolor{blue}{Fördelningsfamiljer för diskreta
variabler}}}
\item \textrm{\textbf{\textcolor{blue}{Bernoulli, binomial, multinomial}}}
\item \textrm{\textbf{\textcolor{blue}{Geometrisk}}}
\item \textrm{\textbf{\textcolor{blue}{Poisson}}}
\end{itemize}
\end{frame}

\begin{frame}{Bernoullifördelningen}

\begin{itemize}
\item En fördelningsfamilj är en mängd olika sannolikhetsfördelningar som
indexeras med en eller flera parametrar.\medskip{}
\end{itemize}
\noindent\fbox{\begin{minipage}[t]{1\columnwidth - 2\fboxsep - 2\fboxrule}%
\textcolor{red}{Definition}. En \textrm{\textbf{\textcolor{blue}{Bernoullivariabel}}}\textbf{\textcolor{blue}{{}
}} $X$ kan anta två olika värden, $0$ och $1$. \\
Om $X$ är \textrm{\textbf{\textcolor{blue}{Bernoullifördelad}}} ($X\sim\mathrm{Bernoulli}(p)$)
så gäller att \\
$P(X=1)=p$ och $P(X=0)=q=1-p.$%
\end{minipage}}\medskip{}

\begin{itemize}
\item Genom att ändra parametern $p$ får vi en mängd olika sannolikhetsfördelningar
på $\{0,1\}$. Se \texttt{\textcolor{red}{ManipDistributions.R}}
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Bernoullifördelningen}

<<BernoulliPlot, echo=FALSE, dev='tikz', out.width='.63\\paperwidth'>>=
@
\end{frame}

\begin{frame}{Bernoullifördelningen}

\begin{itemize}
\item Pmf för $X\sim\mathrm{Bernoulli}(p)$
\[
P(x)=\begin{cases}
q=1-p & \text{om x=0}\\
p & \text{om x=1}
\end{cases}
\]
\item Om $X\sim\mathrm{Bernoulli}(p)$
\[
\mathbb{E}X=p
\]
\[
Var(X)=p\cdot q.
\]
\item Bernoulliförsök: en sekvens av oberoende Bernoullivariabler, alla
med sannolikhet $p$. Slantsingling.
\end{itemize}
\end{frame}

\begin{frame}{Binomialfördelningen}

\noindent\fbox{\begin{minipage}[t]{1\columnwidth - 2\fboxsep - 2\fboxrule}%
\textcolor{red}{Definition}. Antalet lyckade $(X=1)$ i en sekvens
av $n$ Bernoulliförsök med sannolikheten $p$ följer en \textrm{\textbf{\textcolor{blue}{binomialfördelning}}}
med parametrar $n$ och \textrm{\textbf{\textcolor{blue}{$p$.}}}
\\
$X\sim\mathrm{Binomial}(n,p)$.%
\end{minipage}}
\begin{itemize}
\item Pmf
\[
P(x)=\binom{n}{x}p^{x}q^{n-x},
\]
för $x=0,1,2,...,n.$
\item $\binom{n}{x}$ är antalet sekvenser av längd $n$ med exakt $x$
lyckade försök. \textrm{\textbf{\textcolor{blue}{Binomialkoefficienten}}}.
\item Om t ex $n=3$ och $x=2$, så leder alla tre sekvenserna $(0,1,1)$,
$(1,0,1)$ och $(1,1,0)$ till utfallet $x=2$.
\item \texttt{\textcolor{black}{\footnotesize{}Sekvensen $(0,1,1)$ har
sannolikheten $q\cdot p\cdot p=p^{2}q$. }}{\footnotesize\par}
\item \texttt{\textcolor{black}{\footnotesize{}Sekvensen $(1,0,1)$ har
sannolikheten $p\cdot q\cdot p=p^{2}q$. }}{\footnotesize\par}
\item \texttt{\textcolor{black}{\footnotesize{}Sekvensen $(1,1,0)$ har
sannolikheten $p\cdot p\cdot q=p^{2}q$.}}{\footnotesize\par}
\item \textrm{\textcolor{black}{Se }}\texttt{\textcolor{red}{dbinom(x, size,
prob)}} och \texttt{\textcolor{red}{ManipDistributions.R}}
\end{itemize}
\end{frame}

\begin{frame}{Binomialfördelningen}

\begin{itemize}
\item Binomialfördelningen passar data som:

\begin{itemize}
\item \textbf{diskreta icke-negativa heltal}
\item kan anta alla \textbf{heltal mellan $0$ och $n$}.
\end{itemize}
\item Passande: hur många elever i klass 5A kan simma?
\item Inte passande: hur många mål gör IFK Norrköping på lördag? (ingen
naturlig övre gräns) eller längdmätningar (kontinuerliga).
\item \textbf{Väntevärde} och \textbf{varians} för $X\sim Binomial(n,p)$:
\[
\mathbb{E}X=n\cdot p
\]
\[
Var(X)=n\cdot p\cdot q
\]
\item Bevis: $X\sim Binomial(n,p)$ innebär att $X$ är en summa av $n$
oberoende Bernoullivariabler. Väntevärde och varians av summan av
oberoende variabler.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Binomialfördelningen}

<<BinomialPlot, echo=FALSE, dev='tikz', out.width='.63\\paperwidth'>>=
@
\end{frame}

\begin{frame}{Multinomialfördelningen}

\begin{itemize}
\item Bernoullidata: $n$ personer utfrågas om vilket partiblock de föredrar
(röd eller blå). $n_{1}$ personer svarar röd, $n_{2}$ personer svarar
blå.
\item Antal sätt vi kan få dessa data: $\binom{n}{n_{1}}=\frac{n!}{n_{1}!n_{2}!}$
\item Sannolikheten för att få $n_{1}$ röda i $n$ försök:
\[
P(n_{1})=\binom{n}{n_{1}}p^{n_{1}}q^{n_{2}},
\]
\end{itemize}
\begin{center}
\includegraphics[scale=0.2]{nchoosekPlain}
\par\end{center}

\end{frame}

\begin{frame}{Multinomialfördelningen}

\begin{itemize}
\item Multinomiala data: $n$ personer utfrågas om vilket partiblock de
föredrar (röd, blå eller grön). $n_{1}$ personer svarar blå, $n_{2}$
personer svarar röd och $n_{3}$ personer svarar grön.
\item Antal sätt vi kan få dessa data ges av \textbf{multinomialkoefficienten}:
$\binom{n}{n_{1}\,n_{2}\,n_{3}}=\frac{n!}{n_{1}!n_{2}!n_{3}!}$ och
\[
P(n_{1},n_{2},n_{3})=\binom{n}{n_{1}\,n_{2}\,n_{3}}p_{1}^{n_{1}}p_{2}^{n_{2}}p_{3}^{n_{3}},
\]
\item Notera att multinomialfördelningen är en simultanfördelning för \textbf{tre}
slumpvariabler: $N_{1},N_{2}$ och $N_{3}$.
\end{itemize}
\begin{center}
\includegraphics[scale=0.18]{multinomialCoeff}
\par\end{center}

\end{frame}

\begin{frame}{Geometrisk fördelning}

\begin{itemize}
\item Låt $X_{1},X_{2},...$ vara en sekvens Bernoulliförsök med sannolikhet$p$.
\item $X=$ \textbf{antalet försök för att få ett lyckat} \textbf{försök}.
\item $X\sim Geo(p)$ med \textbf{pmf}
\[
P(x)=(1-p)^{x-1}p\;\;,x=1,2,...
\]
\item Geometrisk fördelning passar data:

\begin{itemize}
\item som antar \textbf{diskreta positiva heltal: }1,2,3,...
\item som\textbf{ inte har en övre gräns} (jfr binomial)
\item med \textbf{monotont avtagande pmf}.
\end{itemize}
\item Egenskaper för $X\sim Geo(p)$

\begin{itemize}
\item $\mathbb{E}X=1/p$
\item $Var(X)=\frac{1-p}{p^{2}}$
\end{itemize}
\item Väntevärde och varians beräknas med hjälp av den geometriska serien,
se sid 61 i Baron.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Geometrisk fördelning}

<<GeometricPlot, echo=FALSE, dev='tikz', out.width='.63\\paperwidth'>>=
@
\end{frame}

\begin{frame}[fragile]{Exempel: level up!}

\begin{itemize}
\item Sannolikheten att du klarar en nivå på ett spel är $p$. De olika
försöken är oberoende. Förväntat antal spel innan du klarar nivån?
Svar: $1/p$.
\item Antag nu att du klarar en nivå vid $r:$te försöket med sannolikheten
$1-(1-p)^{r}$. Förväntat antal spel? Svar: inte geometrisk.
\end{itemize}
<<simgame, echo=TRUE, tidy=TRUE, size='tiny'>>=
@
\end{frame}

\begin{frame}{Poissonfördelning}

\noindent\fbox{\begin{minipage}[t]{1\columnwidth - 2\fboxsep - 2\fboxrule}%
\textcolor{red}{Definition}. En Poissonfördelad slumpvariabel med
frekvens $\lambda$, $X\sim Po(\lambda)$, har pmf\\
$P(x)=\frac{e^{-\lambda}\lambda^{x}}{x!}\quad x=0,1,2,...$ %
\end{minipage}}
\begin{itemize}
\item Egenskaper: Om $X\sim Po(\lambda)$

\begin{itemize}
\item $\mathbb{E}X=\lambda$
\item $Var(X)=\lambda$
\end{itemize}
\item Väntevärde och varians beräknas med Taylorutvecklingen: 
\[
e^{\lambda}=\sum_{x=0}^{\infty}\frac{\lambda^{x}}{x!}
\]
.
\item Poissonfördelningen passar data:

\begin{itemize}
\item som antar \textbf{diskreta icke-negativa heltal: }0,1,2,...
\item som\textbf{ inte har en övre gräns} (jfr binomial)
\item vars väntevärde och varians är ungefär lika
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Poissonfördelning}

\begin{itemize}
\item Exempel 1: antalet upptäckta buggar i en kod.
\item Exempel 2: antalet döda i trafiken under år 2014.
\item Poissonfördelning med $\lambda=n\cdot p$ kan användas för att approximera
binomialfördelningen när $n\geq30$ and $p\text{\ensuremath{\leq}0.05}$.
\end{itemize}
\end{frame}

\begin{frame}[fragile]{Poissonfördelning}

<<PoissonPlot, echo=FALSE, dev='tikz', out.width='.63\\paperwidth'>>=
@
\end{frame}


\end{document}
